---
description: Quick-start checklist for analyzing logs efficiently (TL;DR version)
tags: [logging, diagnostics, debugging, quick-reference]
---

# Log Analysis Quick Start (5-Minute Version)

Use this when you need to analyze logs quickly. For detailed guidance, see `log-analysis-guidelines.mdc`.

---

## Step 1: Scan the Logs (30 seconds)
```bash
# What you're looking for:
grep -i "error\|critical\|exception\|failed\|timeout\|closed" logs.txt

# What you need to know:
- Time range: [first timestamp] to [last timestamp]
- Severity: Are there CRITICAL/ERROR logs?
- Pattern: Do errors repeat? Are they cascading?
```

**Output**: List of problems with timestamps

---

## Step 2: Build Timeline (1 minute)
```
[Start: 14:00]
    â†“
[Query successful: 14:00:01]
    â†“
[LLM call: 14:00:05]
    â†“
ğŸ”´ FILE CHANGE: 14:01:10
    â†“
ğŸ”´ WEBSOCKET CLOSE: 14:01:10
    â†“
[Client disconnect: 14:01:17]
    â†“
[End: 14:01:17]
```

**Question**: What sequence led to failure?

---

## Step 3: Extract Key Events (1 minute)

### For Each Major Event, Note:
```
Event: [What happened?]
Time:  [When?]
Why:   [Why did it happen?]
Impact: [What went wrong for user?]
```

**Example from VSM logs:**
```
Event:  File watcher triggered reload
Time:   14:01:10
Why:    scripts/get_tree_session_data.py was modified
Impact: Server shutdown mid-request, WebSocket closed
```

---

## Step 4: Identify Root Cause (1 minute)

**Ask 3 Questions:**

1. â“ **What was the FIRST thing that went wrong?**
   - File watcher reload (not the WebSocket error - that came after)

2. â“ **Why did that happen?**
   - File was modified during active request with no protection

3. â“ **What safeguard was missing?**
   - No check for active connections before shutdown

**Result**: Root cause identified = **Unprotected shutdown during in-flight request**

---

## Step 5: Build Expected vs Actual (1 minute)

```
What Should Have Happened        | What Actually Happened
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
Query executes âœ“                 | Query executed âœ“
LLM processes âœ“                  | LLM processed (200 OK) âœ“
Response sent to frontend         | âŒ WebSocket closed first
User sees answer                  | âŒ User sees nothing
```

---

## The Report (Structured Format)

### Heading
```
[System] Failure Analysis - [Date/Time]
Status: ğŸ”´ CRITICAL / ğŸŸ  HIGH / ğŸŸ¡ MEDIUM / ğŸŸ¢ LOW
```

### What Failed
```
â€¢ Operation: [What were you trying to do?]
â€¢ Result: [What happened instead?]
â€¢ Severity: [How bad?]
```

### Why It Failed (Root Cause)
```
TRIGGER:  [What event started this?]
CAUSE:    [Why it failed?]
MISSING:  [What wasn't there to prevent it?]
```

### Evidence
```
Log Line 1: [Relevant log excerpt with timestamp]
Log Line 2: [Next related log excerpt]
Log Line 3: [Where it failed]
```

### Fix
```
1. [Most important thing to change]
2. [Second priority]
3. [Nice to have]
```

---

## Template (Copy & Paste)

```markdown
# [System] Log Analysis - [Date]

## Status
ğŸ”´ CRITICAL: [One sentence about the problem]

## Timeline
- **Start**: [time]
- **Failure**: [time] - [what happened]
- **End**: [time]
- **Duration**: [X seconds]

## Issue Summary
| Aspect | Details |
|--------|---------|
| What Failed | [operation name] |
| Root Cause | [fundamental reason] |
| Severity | ğŸ”´ CRITICAL |
| User Impact | [what user saw/didn't see] |

## Root Cause Chain
```
[Trigger Event] 
    â†“ (because)
[Direct Cause]
    â†“ (because)
[Contributing Factor]
    â†“ (because)
[Root Cause: Fundamental Issue]
```

## Evidence
```
14:01:10 ERROR: "WatchFiles detected changes..."
14:01:10 WARNING: "Closing WebSocket: Unexpected ASGI message..."
14:01:17 INFO: "Client disconnected during processing"
```

## Expected vs Actual
| Stage | Expected | Actual |
|-------|----------|--------|
| Query | âœ“ Results | âœ“ 1+5 results |
| LLM | âœ“ Response | âœ“ 200 OK (27s) |
| Deliver | âœ“ Send to client | âŒ Socket closed |

## Fixes (Priority Order)
1. ğŸ”´ [Most critical fix]
2. ğŸ”´ [Second critical]
3. ğŸŸ¡ [Important]
4. ğŸŸ¢ [Nice-to-have]

## How to Verify
- [ ] Fix #1 implemented
- [ ] Modify file during long LLM call â†’ response still delivered
- [ ] 10 consecutive queries â†’ 100% success
```

---

## Common Issues (Quick Reference)

### âœ‹ "I see lots of errors. Where do I start?"
â†’ Find the **first error** with the earliest timestamp
â†’ That's where it started

### âœ‹ "Multiple errors in a row. Are they related?"
â†’ Check the **cascade pattern**: Error A â†’ Error B â†’ Error C
â†’ Fix the root cause (usually Error A), others disappear

### âœ‹ "The logs show 200 OK but the user saw nothing"
â†’ Look for **connection/delivery failures** AFTER the success
â†’ The operation succeeded but wasn't delivered

### âœ‹ "Everything looks normal but something's wrong"
â†’ Check **timing data**: Are operations taking 10x longer?
â†’ Look for **subtle state errors**: Was a condition false when it should be true?

### âœ‹ "I don't know where to start"
â†’ Answer these 5 questions:
   1. When did the user report the problem?
   2. What were they trying to do?
   3. What happened instead?
   4. When did the error logs start?
   5. What changed recently?

---

## Red Flags (Instant Problem Indicators)

| Flag | Meaning |
|------|---------|
| `CRITICAL` in logs | Stop, read this line immediately |
| `connection closed` / `socket closed` | Data delivery problem |
| Same error 10+ times | Cascading failure, fix root cause |
| Timeout | Something took too long or was starved |
| `BEFORE` error then `AFTER` error | Cascading: fix the BEFORE one |
| Timestamp jumps 10+ seconds | Long operation, check if it finished |
| No logs after error | Process crashed/stopped |
| Different error stacks | Multiple things going wrong (bad) |

---

## Decision Tree: What's the Problem?

```
Is there an ERROR or CRITICAL log?
â”œâ”€ YES â†’ Find FIRST one
â”‚        â”œâ”€ Network error? â†’ Connection problem
â”‚        â”œâ”€ Timeout? â†’ System too slow or hung
â”‚        â”œâ”€ Not found? â†’ Missing config/dependency
â”‚        â””â”€ Other? â†’ Application logic error
â”‚
â””â”€ NO â†’ Check WARNING logs
         â”œâ”€ Many warnings? â†’ System degrading
         â””â”€ Few warnings? â†’ Likely benign
         
Is the operation marked as COMPLETE?
â”œâ”€ NO â†’ Operation never finished
â”‚        â”œâ”€ Was there a shutdown? â†’ Incomplete operation
â”‚        â”œâ”€ Was there a timeout? â†’ Resource exhaustion
â”‚        â””â”€ No indication? â†’ Missing logging
â”‚
â””â”€ YES â†’ Check if result was delivered
         â”œâ”€ User got result? â†’ Success
         â””â”€ User got nothing? â†’ Delivery failure
```

---

## Timing Analysis Shortcut

**Normal operation**: 100-500ms per phase
**LLM/API call**: 20-60 seconds acceptable
**Database query**: 10-100ms typical

**Red flags**:
- Single operation > 60 seconds (unless LLM/external API)
- Phase taking 10x longer than others â†’ bottleneck
- Immediate 0ms transitions â†’ missing logging or batching

```bash
# Extract timing data quickly:
grep "timestamp_start\|timestamp_end" logs.txt | awk '{print $1, $NF}'
```

---

## When You're Done

You should be able to state:

âœ… **What**: One sentence describing what failed
âœ… **Why**: One sentence explaining root cause  
âœ… **When**: Exact timestamp
âœ… **Impact**: What user experienced
âœ… **Fix**: Top 3 changes needed

---

## Save This Workflow

Use this exact flow for consistency:

1. **Scan** â†’ Identify severity
2. **Timeline** â†’ Understand sequence
3. **Extract** â†’ Pull key events
4. **Analyze** â†’ Find root cause
5. **Document** â†’ Fill template
6. **Recommend** â†’ Suggest fixes
7. **Verify** â†’ Create test cases

**Total time**: 5-10 minutes per set of logs

---

## If Stuck

Ask these questions in order:

1. What should have happened? â† Define expected
2. What actually happened? â† Observe actual
3. When did it differ? â† Find divergence point
4. Why did it differ? â† Find cause
5. What was missing? â† Find root cause
6. How do I fix it? â† Solution

Do NOT skip to step 6 without answering 1-5.

---

## Pro Tips

ğŸ’¡ **Tip 1**: Ctrl+F for "ERROR" first, then expand context
ğŸ’¡ **Tip 2**: Look for the words "closed", "timeout", "failed" - they usually mark problems
ğŸ’¡ **Tip 3**: Multiple errors at same timestamp often means one caused the others
ğŸ’¡ **Tip 4**: Check the LAST 50 lines - they often show what the system was doing when it crashed
ğŸ’¡ **Tip 5**: Correlate with code changes - what was modified recently?

---

## One-Page Template

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ FAILURE ANALYSIS - [System] - [Date]        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ SEVERITY: ğŸ”´ CRITICAL                       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ WHAT:  [operation failed, got nothing]     â”‚
â”‚ WHY:   [file change triggered shutdown]    â”‚
â”‚ WHEN:  [14:01:10-14:01:17]                  â”‚
â”‚ PROOF: [log excerpts with timestamps]      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ ROOT CAUSE: Unprotected shutdown            â”‚
â”‚   1. File modified â†’ watcher triggered      â”‚
â”‚   2. Server shut down mid-request           â”‚
â”‚   3. WebSocket closed before response sent  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ FIX:                                        â”‚
â”‚   ğŸ”´ Disable file watcher during requests   â”‚
â”‚   ğŸ”´ Add request-in-flight protection       â”‚
â”‚   ğŸŸ¡ Buffer responses before sending        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

See `log-analysis-guidelines.mdc` for detailed version.
