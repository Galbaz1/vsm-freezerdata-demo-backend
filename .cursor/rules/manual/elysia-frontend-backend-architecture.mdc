---
alwaysApply: false
---

# Elysia Frontend/Backend Architecture

## Overview

Elysia uses a **separate repositories, unified deployment** architecture where the frontend (Next.js) and backend (FastAPI/Python) are maintained in separate repositories but deployed together as a single application.

## Key Architecture Decision: Static HTML Serving

### Why Separate Repos?

The frontend and backend are maintained in separate repositories for:
- **Independent development**: Frontend (Next.js/React) and backend (Python/FastAPI) can be developed by different teams
- **Technology isolation**: Frontend uses Node.js ecosystem, backend uses Python ecosystem
- **Version control separation**: Each repo has its own commit history and release cycle

### How They Work Together: Static HTML Serving

Despite being separate repos, Elysia uses a **static HTML serving** approach for unified deployment:

1. **Frontend Build Process**:
   - Frontend is built as a Next.js static export (`npm run assemble`)
   - Build output generates static HTML, CSS, and JavaScript files
   - Files are copied to `elysia/api/static/` directory in the backend repo

2. **Backend Serving**:
   - FastAPI serves the static frontend files from `elysia/api/static/`
   - Root route (`/`) serves `static/index.html`
   - Next.js assets are served from `/_next` and `/static` paths
   - Single server deployment: `elysia start` serves both API and frontend

3. **Code Reference**:
   ```python
   # elysia/api/app.py
   app.mount("/_next", StaticFiles(directory=BASE_DIR / "static/_next"))
   app.mount("/static", StaticFiles(directory=BASE_DIR / "static"))
   
   @app.get("/")
   async def serve_frontend():
       return FileResponse(os.path.join(BASE_DIR, "static/index.html"))
   ```

## Benefits of This Architecture

1. **Single Deployment**: One FastAPI server serves both API and frontend
2. **No Separate Frontend Hosting**: No need for separate frontend server/CDN
3. **Pre-built Optimization**: Static files are pre-built and optimized
4. **Simpler for End Users**: `elysia start` serves everything

## VSM Project Context

### Current State

- **Note**: The `apps/elysia-frontend/` directory may not exist in all branches
- This is expected - the frontend is maintained in a separate repository
- When frontend customization is needed, the frontend repo should be integrated

### Frontend Integration Workflow

When working with the frontend:

1. **Development Mode**:
   ```bash
   cd apps/elysia-frontend
   npm run dev  # Runs on localhost:3000, connects to backend at localhost:8000
   ```

2. **Build and Deploy**:
   ```bash
   cd apps/elysia-frontend
   npm run assemble  # Builds and copies to ../../elysia/api/static/
   ```

3. **Backend Serves It**:
   ```bash
   elysia start  # Serves both API and frontend from one server
   ```

### For VSM Customization

When making serious frontend changes (e.g., SMIDO workflow visualization):

- **Keep frontend as embedded repo** (not submodule) because:
  - Heavy customization needed (VSM-specific features)
  - Part of VSM project, not upstream dependency
  - Easier to modify without submodule workflow complexity

- **Build process**: Customize frontend → `npm run assemble` → Backend serves updated static files

## Reference

- **Elysia Blog**: [Elysia: Building an end-to-end agentic RAG app](https://weaviate.io/blog/elysia-agentic-rag)
- **Frontend Repo**: [github.com/weaviate/elysia-frontend](https://github.com/weaviate/elysia-frontend)
- **Backend Repo**: [github.com/weaviate/elysia](https://github.com/weaviate/elysia)

## Key Takeaway

Elysia's architecture separates **development** (two repos) from **deployment** (one server). The frontend is built into static files that the backend serves, creating a unified application experience while maintaining clean separation of concerns during development.
